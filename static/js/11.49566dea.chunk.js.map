{"version":3,"sources":["pages/administration/AdministrationAddModal.tsx","pages/administration/AdministrationPage.tsx","utils/Upload.ts","services/AdministrationService.ts"],"names":["formItemLayout","labelCol","span","wrapperCol","create","props","preData","getPreData","isEditMode","undefined","useState","submitting","setSubmitting","form","getFieldDecorator","validateFieldsAndScroll","getFieldValue","setFieldsValue","handleSubmit","e","preventDefault","error","values","setCanClosable","files","uploadResultSerialization","avatar","process","body","username","nickname","email","length","mobile","status","handleEditSubmit","handleAddSubmit","password","repassword","handleDoSubmit","a","AdministrationService","addAdministration","err","showMessage","close","onComplete","success","updateAdministration","id","useEffect","uploadPreData","spinning","layout","onSubmit","Item","label","extra","rules","validator","rule","value","cb","Error","initialValue","valuePropName","getValueFromEvent","uploadGetValueFromEvent","data","type","headers","UserService","getUserToken","customRequest","uploadCustomRequest","action","listType","className","required","message","autoFocus","placeholder","checkedChildren","unCheckedChildren","block","htmlType","AdministrationPage","columns","title","dataIndex","width","align","render","_","row","src","style","height","verticalAlign","borderRadius","alt","text","color","size","onClick","WLModal","openModal","AdministrationAddModal","defaultCanDismiss","refresh","confirm","onOk","setLoading","failBack","deleteAdministration","useAdministrationList","total","isLoading","isError","page","setPage","marginBottom","margin","showIcon","description","closable","bordered","loading","delay","locale","emptyText","pagination","rowKey","dataSource","marginTop","textAlign","current","pageSize","disabled","hideOnSinglePage","onChange","options","onProgress","onError","onSuccess","withCredentials","file","filename","xhr","XMLHttpRequest","fd","FormData","append","Object","keys","forEach","key","open","setRequestHeader","upload","onprogress","percent","loaded","onerror","ontimeout","response","onabort","onload","readyState","JSON","parse","_getResponse","code","msg","send","abort","Array","isArray","fileList","fileEvents","host","map","item","url","replace","RegExp","uid","uniqueId","name","BaseService","useServiceListBase","addServiceBase","updateServiceBase","deleteServiceBase","toggleAdministrationStatus"],"mappings":"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","file":"static/js/11.49566dea.chunk.js","sourcesContent":["import React, {useEffect, useState} from \"react\";\nimport AdministrationService, {IAdministration} from \"../../services/AdministrationService\";\nimport {Button, Form, Input, Switch, Spin, message, Upload, Icon} from \"antd\";\nimport {FormComponentProps} from \"antd/lib/form\";\nimport {IWLModalInjectProps} from \"../../components/wl-modal/WLModal\";\nimport UserService from \"../../services/UserService\";\nimport {\n  uploadCustomRequest,\n  uploadGetValueFromEvent,\n  uploadPreData,\n  uploadResultSerialization\n} from \"../../utils/Upload\";\n\ninterface Props extends FormComponentProps<IAdministration & { avatar: any[] }>, IWLModalInjectProps {\n}\n\nconst formItemLayout = {\n  labelCol: {span: 4},\n  wrapperCol: {span: 20},\n};\nconst AdministrationAddModal: React.FC<Props> = (props) => {\n  const preData = props.getPreData<IAdministration>();\n  const isEditMode = preData !== undefined;\n  const [submitting, setSubmitting] = useState(false);\n  const {getFieldDecorator, validateFieldsAndScroll, getFieldValue, setFieldsValue} = props.form;\n\n  function handleSubmit(e: React.FormEvent<HTMLFormElement>) {\n    e.preventDefault();\n    validateFieldsAndScroll((error, values) => {\n      if (error) {\n        return;\n      }\n      handleDoSubmit(values);\n    });\n  }\n\n  function handleDoSubmit(values: IAdministration & { password?: string, repassword?: string, avatar: any[] }) {\n    props.setCanClosable(false);\n    setSubmitting(true);\n    const files = uploadResultSerialization(values.avatar, process.env.REACT_APP_API_BASE_URL);\n    const body: IAdministration = {\n      username: values.username,\n      nickname: values.nickname,\n      email: values.email,\n      avatar: files.length > 0 ? files[0] : null,\n      mobile: values.mobile,\n      status: values.status ? 1 : 0,\n    };\n    if (isEditMode) {\n      handleEditSubmit(body);\n    } else {\n      const addBody: IAdministration & { password: string, repassword: string } = {\n        ...body,\n        password: values.password!,\n        repassword: values.repassword!,\n      };\n      handleAddSubmit(addBody);\n    }\n  }\n\n  async function handleAddSubmit(values: IAdministration & { password: string, repassword: string }) {\n    const [, err] = await AdministrationService.addAdministration(values);\n    props.setCanClosable(true);\n    setSubmitting(false);\n    if (err) {\n      err.showMessage();\n      return;\n    }\n    props.close();\n    props.onComplete!();\n    message.success('添加成功!');\n  }\n\n  async function handleEditSubmit(values: IAdministration) {\n    const [, err] = await AdministrationService.updateAdministration(preData.id!, values);\n    props.setCanClosable(true);\n    setSubmitting(false);\n    if (err) {\n      err.showMessage();\n      return;\n    }\n    props.close();\n    props.onComplete!();\n    message.success('编辑成功!');\n  }\n\n  useEffect(() => {\n    if (isEditMode) {\n      setFieldsValue({\n        avatar: preData.avatar ? uploadPreData([preData.avatar]) : [],\n        username: preData.username,\n        nickname: preData.nickname,\n        mobile: preData.mobile,\n        email: preData.email,\n        status: preData.status === 1,\n      });\n    }\n    // eslint-disable-next-line\n  }, []);\n  const avatar = getFieldValue('avatar') || [];\n  return (\n    <Spin spinning={submitting}>\n      <Form layout={\"horizontal\"} onSubmit={e => handleSubmit(e)}>\n        <Form.Item label={\"头像\"} {...formItemLayout} extra=\"上传 jpg/png 文件\">\n          {getFieldDecorator('avatar', {\n            rules: [\n              // {validator: (rule, value: any[], cb) => {\n              //     if(value.length === 0) {\n              //       cb(new Error('请上传头像'));\n              //     }\n              //     cb();\n              //   }},\n              {\n                validator: (rule, value: any[], cb) => {\n                  for (let item of value) {\n                    if (item.status === 'error') {\n                      cb(new Error('图片上传失败, 请重试'));\n                    }\n                  }\n                  cb();\n                }\n              },\n            ],\n            initialValue: [],\n            valuePropName: 'fileList',\n            getValueFromEvent: uploadGetValueFromEvent,\n          })(<Upload\n            data={{type: 'user'}}\n            headers={{'X-Token': UserService.getUserToken()!}}\n            customRequest={uploadCustomRequest}\n            action={`${process.env.REACT_APP_API_BASE_URL}/upload/files`}\n            listType=\"picture-card\">\n            {avatar.length === 0 && (\n              <>\n                <Icon type=\"plus\"/>\n                <div className=\"ant-upload-text\">选择文件</div>\n              </>\n            )}\n          </Upload>)}\n        </Form.Item>\n        <Form.Item label={\"用户名\"} {...formItemLayout}>\n          {getFieldDecorator('username', {\n            rules: [{required: true, message: '请输入用户名'}],\n          })(<Input autoFocus placeholder={\"请输入用户名\"}/>)}\n        </Form.Item>\n        <Form.Item label={\"昵称\"} {...formItemLayout}>\n          {getFieldDecorator('nickname', {\n            rules: [{required: true, message: '请输入昵称'}],\n          })(<Input placeholder={\"请输入昵称\"}/>)}\n        </Form.Item>\n        {!isEditMode && (\n          <>\n            <Form.Item label={\"密码\"} {...formItemLayout}>\n              {getFieldDecorator('password', {\n                rules: [{required: true, message: '请输入密码'}],\n              })(<Input type={\"password\"} placeholder={\"请输入密码\"}/>)}\n            </Form.Item>\n            <Form.Item label={\"确认密码\"} {...formItemLayout}>\n              {getFieldDecorator('repassword', {\n                rules: [{required: true, message: '请输入确认密码'}],\n              })(<Input type={\"password\"} placeholder={\"请输入确认密码\"}/>)}\n            </Form.Item>\n          </>\n        )}\n        <Form.Item label={\"手机号码\"} {...formItemLayout}>\n          {getFieldDecorator('mobile', {\n            rules: [{required: true, message: '请输入手机号码'}],\n          })(<Input placeholder={\"请输入手机号码\"}/>)}\n        </Form.Item>\n        <Form.Item label={\"邮箱\"} {...formItemLayout}>\n          {getFieldDecorator('email', {\n            rules: [{required: true, message: '请输入邮箱'}],\n          })(<Input placeholder={\"请输入邮箱\"}/>)}\n        </Form.Item>\n\n        <Form.Item label={\"状态\"} {...formItemLayout}>\n          {getFieldDecorator('status', {\n            rules: [],\n            valuePropName: 'checked',\n            initialValue: true,\n          })(<Switch checkedChildren={\"启用\"} unCheckedChildren={\"禁用\"}/>)}\n        </Form.Item>\n        <Form.Item>\n          <Button type=\"primary\"\n                  block\n                  htmlType=\"submit\">\n            提交\n          </Button>\n        </Form.Item>\n      </Form>\n    </Spin>\n  );\n\n};\n\nexport default Form.create()(AdministrationAddModal);\n","import React from 'react';\nimport {Table, Button, Icon, Pagination, Alert, Tag, message} from 'antd';\nimport {ColumnProps} from \"antd/lib/table\";\nimport AdministrationService, {IAdministration} from \"../../services/AdministrationService\";\nimport WLModal from \"../../components/wl-modal/WLModal\";\nimport AdministrationAddModal from \"./AdministrationAddModal\";\n\ninterface Props {\n\n}\n\nconst AdministrationPage: React.FC<Props> = (props) => {\n  const columns: ColumnProps<IAdministration>[] = [\n    {title: '账号', dataIndex: 'username', width: 160, align: 'left',},\n    {\n      title: '头像&昵称', dataIndex: 'nickname', width: 200, align: 'left', render: (_, row) => {\n        return (\n          <>\n            <img src={row.avatar as string}\n                 style={{height: '30px', width: '30px', verticalAlign: 'middle', borderRadius: '5px'}}\n                 alt=\"\"/>&nbsp;&nbsp;\n            <span>{row.nickname}</span>\n          </>\n        );\n      }\n    },\n    {title: '电话号码', dataIndex: 'mobile', width: 140},\n    {title: '邮箱', dataIndex: 'email', width: 300},\n    {\n      title: '状态', dataIndex: 'status', render: (text) => {\n        return (\n          <Tag color={text === 1 ? 'blue' : 'red'}>\n            {text === 1 ? '启用' : '禁用'}\n          </Tag>\n        );\n      }\n    },\n    {\n      title: '操作', align: 'center', width: 120, render: (_, row) => {\n        return (\n          <>\n            <Button size={\"small\"}\n                    type={\"primary\"}\n                    onClick={() => {\n                      WLModal.openModal(AdministrationAddModal, {\n                        title: '编辑管理员',\n                        data: row,\n                        defaultCanDismiss: false,\n                        onComplete() {\n                          refresh();\n                        }\n                      });\n                    }}>编辑</Button>\n            &nbsp;\n            <Button size={\"small\"}\n                    type={\"danger\"}\n                    onClick={() => {\n                      WLModal.confirm(\"确实要删除吗?\", {\n                        async onOk({setLoading, close, failBack}) {\n                          setLoading();\n                          const [, err] = await AdministrationService.deleteAdministration([row.id!]);\n                          if (err) {\n                            err.showMessage();\n                            failBack();\n                            return;\n                          }\n                          close();\n                          refresh();\n                          message.success('删除成功!');\n                        }\n                      });\n                    }}>删除</Button>\n          </>\n        );\n      }\n    },\n  ];\n  const {total, data, isLoading, isError, page, setPage, refresh} = AdministrationService.useAdministrationList();\n\n  function handleAddAdministration() {\n    WLModal.openModal(AdministrationAddModal, {\n      title: '添加管理员',\n      defaultCanDismiss: false,\n      onComplete() {\n        refresh();\n      }\n    });\n\n  }\n\n  return (\n    <div className={\"frame-content\"}>\n      <div style={{marginBottom: '20px'}}>\n        <Button onClick={handleAddAdministration} type={\"primary\"}>\n          <Icon type={\"plus\"}/>\n          添加管理员\n        </Button>\n\n      </div>\n\n      {isError && (\n        <Alert style={{margin: '0 0 20px 0'}}\n               showIcon\n               message={\"抱歉\"}\n               description={(\n                 <>\n                   <span>出现了一点问题, 请稍后再试或</span>\n                   <Button type={\"link\"} onClick={() => refresh()}>点击重试</Button>\n                 </>\n               )}\n               type=\"error\"\n               closable\n        />\n      )}\n      <Table size={\"small\"}\n             bordered\n             loading={{\n               spinning: isLoading,\n               delay: 250,\n             }}\n             locale={{\n               emptyText: isLoading ? '拼命加载中...' : '抱歉, 暂无数据'\n             }}\n             pagination={false}\n             rowKey={\"id\"}\n             columns={columns}\n             dataSource={data}/>\n      <Pagination style={{marginTop: '20px', textAlign: 'right'}} current={page}\n                  pageSize={20}\n                  disabled={isLoading}\n                  hideOnSinglePage\n                  onChange={page => setPage(page)}\n                  total={total}/>\n    </div>\n  );\n};\nexport default AdministrationPage;\n","import uniqueId from 'lodash/uniqueId';\nfunction _getResponse(response: string) {\n  try {\n    return JSON.parse(response);\n  } catch (e) {\n    return response;\n  }\n}\nexport function uploadCustomRequest(options: { [s: string]: any }) {\n  const {action, data, headers, onProgress, onError, onSuccess, withCredentials, file, filename} = options;\n  const xhr = new XMLHttpRequest();\n  const fd = new FormData();\n  fd.append(filename, file);\n  Object.keys(data).forEach(key => {\n    fd.append(key, data[key]);\n  });\n  xhr.open('POST', action);\n  Object.keys(headers).forEach(key => {\n    xhr.setRequestHeader(key, headers[key]);\n  });\n  xhr.withCredentials = withCredentials;\n  xhr.upload.onprogress = e => {\n    onProgress({percent: e.loaded / e.total * 100})\n  };\n  xhr.onerror = xhr.ontimeout = () => {\n    onError(xhr.response);\n  };\n  xhr.onabort = () => {\n  };\n  xhr.onload = () => {\n    if (xhr.readyState === 4) {\n      const response = _getResponse(xhr.response);\n      if (response.code === 200) {\n        onSuccess(response.data)\n      } else {\n        onError(response.msg || response);\n      }\n    } else {\n      onError(xhr.response);\n    }\n  };\n  xhr.send(fd);\n  return {\n    abort() {\n      xhr.abort();\n    }\n  };\n}\nexport function uploadGetValueFromEvent(e: any) {\n  if (Array.isArray(e)) {\n    return e;\n  }\n  return e && e.fileList;\n}\nexport function uploadResultSerialization(fileEvents: any[], host = ''): string[] {\n  return fileEvents.map(item => {\n    return item.response ? (item.response as string[])[0] : item.url.replace(new RegExp(`^${host}`), '');\n  });\n}\nexport function uploadPreData(data: string[]) {\n  return data.map(item => {\n    return {\n      uid: uniqueId('_upload_'),\n      name: uniqueId('_upload_name_'),\n      status: 'done',\n      url: item,\n    };\n  });\n}\n","import BaseService from \"./BaseService\";\n\nconst useAdministrationList = () => BaseService.useServiceListBase<IAdministration>('/user/index');\n\nconst addAdministration = BaseService.addServiceBase<IAdministration & {password: string, repassword: string}>('/user/add');\n\nconst updateAdministration = BaseService.updateServiceBase<IAdministration>('/user/edit');\n\nconst deleteAdministration = BaseService.deleteServiceBase('/user/delete');\n\nconst toggleAdministrationStatus = BaseService.updateServiceBase<{status: boolean}>('/user/edit');\n\nconst AdministrationService = {\n  useAdministrationList,\n  addAdministration,\n  updateAdministration,\n  deleteAdministration,\n  toggleAdministrationStatus,\n};\nexport default AdministrationService;\n\nexport interface IAdministration {\n  id?: number;\n  username: string;\n  nickname: string;\n  avatar?: string | null;\n  email: string;\n  mobile: string;\n  status: number;\n}\n"],"sourceRoot":""}