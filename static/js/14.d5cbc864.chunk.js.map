{"version":3,"sources":["pages/banner/BannerAddModal.tsx","pages/banner/BannerPage.tsx","services/BannerService.ts"],"names":["formItemLayout","labelCol","span","wrapperCol","create","props","preData","getPreData","isEditMode","undefined","useState","submitting","setSubmitting","form","getFieldDecorator","validateFieldsAndScroll","setFieldsValue","handleSubmit","e","preventDefault","error","values","setCanClosable","body","name","status","handleEditSubmit","handleAddSubmit","handleDoSubmit","a","BannerService","addBanner","err","showMessage","close","onComplete","success","updateBanner","id","useEffect","spinning","layout","onSubmit","Item","label","rules","required","message","autoFocus","placeholder","valuePropName","initialValue","checkedChildren","unCheckedChildren","type","block","htmlType","BannerPage","columns","title","dataIndex","width","align","render","text","color","_","row","size","onClick","WLModal","openModal","BannerAddModal","data","defaultCanDismiss","refresh","confirm","onOk","setLoading","failBack","deleteBanner","useBannerList","isError","isLoading","className","style","marginBottom","margin","showIcon","description","closable","bordered","loading","delay","locale","emptyText","pagination","rowKey","dataSource","BaseService","useServiceListBase","addServiceBase","updateServiceBase","deleteServiceBase","toggleBannerStatus"],"mappings":"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","file":"static/js/14.d5cbc864.chunk.js","sourcesContent":["import React, {useEffect, useState} from \"react\";\nimport {Button, Form, Input, Switch, Spin, message} from \"antd\";\nimport {FormComponentProps} from \"antd/lib/form\";\nimport {IWLModalInjectProps} from \"../../components/wl-modal/WLModal\";\nimport BannerService, {IBanner} from \"../../services/BannerService\";\n\ninterface Props extends FormComponentProps<IBanner>, IWLModalInjectProps {\n}\n\nconst formItemLayout = {\n  labelCol: {span: 4},\n  wrapperCol: {span: 20},\n};\nconst BannerAddModal: React.FC<Props> = (props) => {\n  const preData = props.getPreData<IBanner>();\n  const isEditMode = preData !== undefined;\n  const [submitting, setSubmitting] = useState(false);\n  const {getFieldDecorator, validateFieldsAndScroll, setFieldsValue} = props.form;\n\n  function handleSubmit(e: React.FormEvent<HTMLFormElement>) {\n    e.preventDefault();\n    validateFieldsAndScroll((error, values) => {\n      if (error) {\n        return;\n      }\n      handleDoSubmit(values);\n    });\n  }\n\n  function handleDoSubmit(values: IBanner) {\n    props.setCanClosable(false);\n    setSubmitting(true);\n    const body: IBanner = {\n      name: values.name,\n      status: values.status ? 1 : 0,\n    };\n    if (isEditMode) {\n      handleEditSubmit(body);\n    } else {\n      handleAddSubmit(body);\n    }\n  }\n\n  async function handleAddSubmit(values: IBanner) {\n    const [, err] = await BannerService.addBanner(values);\n    props.setCanClosable(true);\n    setSubmitting(false);\n    if (err) {\n      err.showMessage();\n      return;\n    }\n    props.close();\n    props.onComplete!();\n    message.success('添加成功!');\n  }\n\n  async function handleEditSubmit(values: IBanner) {\n    const [, err] = await BannerService.updateBanner(preData.id!, values);\n    props.setCanClosable(true);\n    setSubmitting(false);\n    if (err) {\n      err.showMessage();\n      return;\n    }\n    props.close();\n    props.onComplete!();\n    message.success('编辑成功!');\n  }\n\n  useEffect(() => {\n    if (isEditMode) {\n      setFieldsValue({\n        name: preData.name,\n        status: preData.status === 1,\n      });\n    }\n    // eslint-disable-next-line\n  }, []);\n\n  return (\n    <Spin spinning={submitting}>\n\n      <Form layout={\"horizontal\"} onSubmit={e => handleSubmit(e)}>\n        <Form.Item label={\"分类名称\"} {...formItemLayout}>\n          {getFieldDecorator('name', {\n            rules: [{required: true, message: '请输入分类名称'}],\n          })(<Input autoFocus placeholder={\"请输入分类名称\"}/>)}\n        </Form.Item>\n\n        <Form.Item label={\"状态\"} {...formItemLayout}>\n          {getFieldDecorator('status', {\n            rules: [],\n            valuePropName: 'checked',\n            initialValue: true,\n          })(<Switch checkedChildren={\"启用\"} unCheckedChildren={\"禁用\"}/>)}\n        </Form.Item>\n        <Form.Item>\n          <Button type=\"primary\"\n                  block\n                  htmlType=\"submit\">\n            提交\n          </Button>\n        </Form.Item>\n      </Form>\n    </Spin>\n  );\n\n};\n\nexport default Form.create()(BannerAddModal);\n","import React from 'react';\nimport BannerService, {IBanner} from \"../../services/BannerService\";\nimport {Alert, Button, Icon, message, Table, Tag} from \"antd\";\nimport {ColumnProps} from \"antd/lib/table\";\nimport WLModal from \"../../components/wl-modal/WLModal\";\nimport BannerAddModal from \"./BannerAddModal\";\n\ninterface Props {\n\n}\n\nconst BannerPage: React.FC<Props> = (props) => {\n  const columns: ColumnProps<IBanner>[] = [\n    {title: '名称', dataIndex: 'name', width: 200, align: 'left',},\n    {\n      title: '状态', dataIndex: 'status', render: (text) => {\n        return (\n          <Tag color={text === 1 ? 'blue' : 'red'}>\n            {text === 1 ? '启用' : '禁用'}\n          </Tag>\n        );\n      }\n    },\n    {\n      title: '操作', align: 'center', width: 120, render: (_, row) => {\n        return (\n          <>\n            <Button size={\"small\"}\n                    type={\"primary\"}\n                    onClick={() => {\n                      WLModal.openModal(BannerAddModal, {\n                        title: '编辑分类',\n                        data: row,\n                        defaultCanDismiss: false,\n                        onComplete() {\n                          refresh();\n                        }\n                      });\n                    }}>编辑</Button>\n            &nbsp;\n            <Button size={\"small\"}\n                    type={\"danger\"}\n                    onClick={() => {\n                      WLModal.confirm(\"确实要删除吗?\", {\n                        async onOk({setLoading, close, failBack}) {\n                          setLoading();\n                          const [, err] = await BannerService.deleteBanner([row.id!]);\n                          if (err) {\n                            err.showMessage();\n                            failBack();\n                            return;\n                          }\n                          close();\n                          refresh();\n                          message.success('删除成功!');\n                        }\n                      });\n                    }}>删除</Button>\n          </>\n        );\n      }\n    },\n  ];\n  const {data, isError, isLoading, refresh} = BannerService.useBannerList();\n\n  function handleAddBanner() {\n    WLModal.openModal(BannerAddModal, {\n      title: '添加分类',\n      defaultCanDismiss: false,\n      onComplete() {\n        refresh();\n      }\n    });\n  }\n\n  return (\n    <div className={\"frame-content\"}>\n      <div style={{marginBottom: '20px'}}>\n        <Button onClick={handleAddBanner} type={\"primary\"}>\n          <Icon type={\"plus\"}/>\n          添加 banner 分类\n        </Button>\n      </div>\n      {isError && (\n        <Alert style={{margin: '0 0 20px 0'}}\n               showIcon\n               message={\"抱歉\"}\n               description={(\n                 <>\n                   <span>出现了一点问题, 请稍后再试或</span>\n                   <Button type={\"link\"} onClick={() => refresh()}>点击重试</Button>\n                 </>\n               )}\n               type=\"error\"\n               closable\n        />\n      )}\n      <Table size={\"small\"}\n             bordered\n             loading={{\n               spinning: isLoading,\n               delay: 250,\n             }}\n             locale={{\n               emptyText: isLoading ? '拼命加载中...' : '抱歉, 暂无数据'\n             }}\n             pagination={false}\n             rowKey={\"id\"}\n             columns={columns}\n             dataSource={data}/>\n    </div>\n  );\n};\n\nexport default BannerPage;\n","import BaseService from \"./BaseService\";\n\nconst useBannerList = () => BaseService.useServiceListBase<IBanner>('/banner/index');\n\nconst addBanner = BaseService.addServiceBase<IBanner>('/banner/add');\n\nconst updateBanner = BaseService.updateServiceBase<IBanner>('/banner/edit');\n\nconst deleteBanner = BaseService.deleteServiceBase('/banner/delete');\n\nconst toggleBannerStatus = BaseService.updateServiceBase<{ status: boolean }>('/banner/edit');\n\nconst BannerService = {\n  useBannerList,\n  addBanner,\n  updateBanner,\n  deleteBanner,\n  toggleBannerStatus,\n};\n\nexport default BannerService;\n\nexport interface IBanner {\n  id?: number;\n  name: string;\n  status: number;\n}\n"],"sourceRoot":""}